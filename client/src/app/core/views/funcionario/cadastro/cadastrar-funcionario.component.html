<div class="dashboard-container">
  <mat-card class="no-card-appearence">

    <!-- HEADER -->
    <mat-card-header>
      <mat-card-title class="text-primary">Cadastrar Funcionário</mat-card-title>
      <mat-card-subtitle>Preencha os dados do novo funcionário</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="cadastrar()">

        <!-- GRID ROW 1: Nome + CPF -->
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Nome Completo</mat-label>
            <input matInput formControlName="nome" placeholder="Ex: João da Silva" />
            <mat-icon matPrefix class="icon-destaque">person</mat-icon>

            <mat-error *ngIf="nome?.errors?.['required']">Nome é obrigatório</mat-error>
            <mat-error *ngIf="nome?.errors?.['minlength']">Mínimo de 3 caracteres</mat-error>
            <mat-error *ngIf="nome?.errors?.['maxlength']">Máximo de 50 caracteres</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Cargo</mat-label>
            <mat-select formControlName="cargo">
              <mat-option *ngFor="let cargo of cargosOptions" [value]="cargo.valor">
                {{ cargo.label }}
              </mat-option>
            </mat-select>
            <mat-icon matPrefix class="icon-destaque">work</mat-icon>
            <mat-error *ngIf="cargo?.errors?.['required']">Cargo obrigatório</mat-error>
          </mat-form-field>
        </div>


        <!-- GRID ROW 2: Apelido + Aviso -->
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Apelido</mat-label>
            <input matInput formControlName="nomeApresentacao" placeholder="Ex: Leo" />
            <mat-icon matPrefix class="icon-destaque">person</mat-icon>

            <mat-error *ngIf="nomeApresentacao?.errors?.['minlength']">Mínimo de 3 caracteres</mat-error>
            <mat-error *ngIf="nomeApresentacao?.errors?.['maxlength']">Máximo de 20 caracteres</mat-error>
          </mat-form-field>

            <mat-label for="aviso" >

              <p id="aviso">
              O apelido não é obrigatório, caso seja preenchido
              o nome de apresentação para a aplicação e clientes será prioritário.
            </p>
          </mat-label>
        </div>

        <!-- GRID ROW 3: Username + Email -->
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Nome de Usuário</mat-label>
            <input matInput formControlName="userName" placeholder="Ex: joao.silva" />
            <mat-icon matPrefix class="icon-destaque">account_circle</mat-icon>

            <mat-error *ngIf="userName?.errors?.['required']">Obrigatório</mat-error>
            <mat-error *ngIf="userName?.errors?.['minlength']">Mínimo de 3 caracteres</mat-error>
            <mat-error *ngIf="userName?.errors?.['maxlength']">Máximo de 30 caracteres</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>E-mail</mat-label>
            <input matInput type="email" formControlName="email" placeholder="exemplo@email.com">
            <mat-icon matPrefix class="icon-destaque">email</mat-icon>

            <mat-error *ngIf="email?.errors?.['required']">Email é obrigatório</mat-error>
            <mat-error *ngIf="email?.errors?.['email']">Email inválido</mat-error>
          </mat-form-field>
        </div>

        <!-- GRID ROW 4: Senha + Cargo -->
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Senha</mat-label>
            <input matInput type="password" formControlName="password" placeholder="Digite uma senha forte" />
            <mat-icon matPrefix class="icon-destaque">lock</mat-icon>

            <!-- Dicas de força -->
            <mat-error *ngIf="password?.value" class="dicas senha-dicas">

              <span [class.valido]="!password?.hasError('semMaiuscula')"
                [class.invalido]="password?.hasError('semMaiuscula')">
                <mat-icon>{{ !password?.hasError('semMaiuscula') ? 'check_circle' : 'cancel' }}</mat-icon>
                Maiúscula
              </span>

              <span [class.valido]="!password?.hasError('semMinuscula')"
                [class.invalido]="password?.hasError('semMinuscula')">
                <mat-icon>{{ !password?.hasError('semMinuscula') ? 'check_circle' : 'cancel' }}</mat-icon>
                Minúscula
              </span>

              <span [class.valido]="!password?.hasError('semNumero')"
                [class.invalido]="password?.hasError('semNumero')">
                <mat-icon>{{ !password?.hasError('semNumero') ? 'check_circle' : 'cancel' }}</mat-icon>
                Número
              </span>

              <span [class.valido]="!password?.hasError('semEspecial')"
                [class.invalido]="password?.hasError('semEspecial')">
                <mat-icon>{{ !password?.hasError('semEspecial') ? 'check_circle' : 'cancel' }}</mat-icon>
                Especial
              </span>

              <span [class.valido]="!password?.hasError('senhaLonga')"
                [class.invalido]="password?.hasError('senhaLonga')">
                <mat-icon>{{ !password?.hasError('senhaLonga') ? 'check_circle' : 'cancel' }}</mat-icon>
                Senha muito longa
              </span>

              <span [class.valido]="!password?.hasError('senhaCurta')"
                [class.invalido]="password?.hasError('senhaCurta')">
                <mat-icon>{{ !password?.hasError('senhaCurta') ? 'check_circle' : 'cancel' }}</mat-icon>
                Senha muito curta
              </span>

              <span [class.valido]="!password?.hasError('senhaVazio')"
                [class.invalido]="password?.hasError('senhaVazio')">
                <mat-icon>{{ !password?.hasError('senhaVazio') ? 'check_circle' : 'cancel' }}</mat-icon>
                Senha obrigatória
              </span>
            </mat-error>

            <mat-error *ngIf="password?.errors?.['required']">Senha obrigatória</mat-error>
            <mat-error *ngIf="password?.errors?.['minlength']">Mínimo de 6 caracteres</mat-error>
            <mat-error *ngIf="password?.errors?.['maxlength']">Máximo de 30 caracteres</mat-error>
          </mat-form-field>

          <!-- CPF COMPONENT -->
          <div class="cpf-wrapper">
            <app-cpf-input formControlName="cpf" label="CPF" placeholder="000.000.000-00">
            </app-cpf-input>

            <!-- Validações CPF -->
              <mat-error *ngIf="cpf?.value" class="dicas cpf-dicas">
                <span [class.valido]="!cpf?.hasError('semFormatacao')"
                  [class.invalido]="cpf?.hasError('semFormatacao')">
                  <mat-icon>
                    {{ !cpf?.hasError('semFormatacao') ? 'check_circle' : 'cancel' }}
                  </mat-icon>
                  Cpf Incorreto
                </span>

                <span [class.valido]="!cpf?.hasError('cpfVazio')" [class.invalido]="cpf?.hasError('cpfVazio')">
                  <mat-icon>
                    {{ !cpf?.hasError('cpfVazio') ? 'check_circle' : 'cancel' }}
                  </mat-icon>
                  Cpf obrigatório
                </span>

                <span [class.valido]="!cpf?.hasError('cpfCurto')" [class.invalido]="cpf?.hasError('cpfCurto')">
                  <mat-icon>
                    {{ !cpf?.hasError('cpfCurto') ? 'check_circle' : 'cancel' }}
                  </mat-icon>
                  Cpf muito curto
                </span>

              </mat-error>
            </div>
          </div>

        <!-- ACTION BUTTONS -->
        <div class="form-actions">
          <a mat-button routerLink="/employees/listar" class="btn-outline-secundario">
            <mat-icon>arrow_back</mat-icon>
            Cancelar
          </a>

          <button mat-raised-button class="btn-destaque" type="submit" [disabled]="form.invalid">
            <mat-icon>save</mat-icon>
            Cadastrar
          </button>
        </div>

      </form>
    </mat-card-content>
  </mat-card>
</div>
